/*! Hester Street Collaborative - v1.0.0
 * http://hesterstreet.org/
 * Copyright (c) 2017; * Licensed GPLv2+ */

!function(a){"use strict";a.document;if(a.publicationFilterData){Vue.component("filter-term",{template:'<li class="list__item filter-group__item" v-bind:class="{ \'is-active\' : active }" v-on:click="select">{{ filterObj.name }}</li>',props:["filterObj","isActive"],data:function(){return{active:this.isActive}},watch:{isActive:function(a){this.active=a}},methods:{select:function(){this.$emit("select")}}});new Vue({el:"#publication-archive-app",template:"#publication-archive-template",data:{loading:!0,queryData:{current_page:1,found_posts:0,total_pages:1},currentFilterGroup:"service",currentFilters:{service:[],issue:[],date:!1},publicationFilterData:publicationFilterData,publications:[]},mounted:function(a){this.getPublications(this.getPublicationApiUrl())},computed:{hasFilters:function(){return!!this.currentFilters.service.length||(!!this.currentFilters.issue.length||(!!this.currentFilters.date||void 0))}},methods:{toggleFilterGroup:function(a,b){this.currentFilterGroup=a.slug},toggleFilter:function(a,b){var c=this.currentFilters[a.taxonomy].indexOf(a.slug);c>-1?this.currentFilters[a.taxonomy].splice(c,1):this.currentFilters[a.taxonomy].push(a.slug),this.loading=!0,this.getPublications(this.getPublicationApiUrl())},toggleDate:function(a,b){this.currentFilters.date.seconds==a.seconds?this.currentFilters.date=!1:this.currentFilters.date=a,this.loading=!0,this.getPublications(this.getPublicationApiUrl())},resetFilters:function(){this.currentFilters={service:[],issue:[],date:!1},this.loading=!0,this.getPublications(this.getPublicationApiUrl())},getPublicationApiUrl:function(a){function b(a,b){var c=[];return a.length?(a.forEach(function(a,b){c.push(a)}),c.join("+")):b}a=a||1;var c=b(this.currentFilters.service,"all_services"),d=b(this.currentFilters.issue,"all_issues"),e="all_dates";if(this.currentFilters.date){e=(new Date).getTime()/1e3-this.currentFilters.date.seconds}return this.currentFilters.status&&(status=this.currentFilters.status.slug),[e,c,d,a].join("/")},getPublications:function(a,b){var c=this;this.loading=!0,fetch(HSC.api+"publications/"+a).then(function(a){return a.json()}).then(function(a){c.queryData=a.query,c.publications=b?c.publications.concat(a.posts):a.posts,c.loading=!1}).catch(function(a){console.log("Publication fetch failed",a)})}}})}}(this);
//# sourceMappingURL=archive-publication.min.js.map