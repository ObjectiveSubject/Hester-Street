/*! Hester Street Collaborative - v1.0.0
 * http://hesterstreet.org/
 * Copyright (c) 2018; * Licensed GPLv2+ */

!function(a){"use strict";var b=a.document;new Vue({el:"#project-timeline",data:{appClassArray:["is-loading"],loading:!0,stickySidebar:null,allTimelineItems:[],scrollMagicController:!1},mounted:function(){projectData&&projectData.id&&(this.getTimelineItems(projectData.id),this.stickySidebar=new Sticky(".project-timeline__sidebar",{marginTop:16,stickyFor:1e3,stickyContainer:".project-timeline__sidebar-wrap"}))},computed:{appClass:function(){return this.appClassArray.join(" ")},visibleTimelineItems:function(){return this.allTimelineItems}},watch:{visibleTimelineItems:function(){this.scrollMagicController&&this.scrollMagicController.destroy(),setTimeout(this.setupScrollMagic,100),this.stickySidebar&&setTimeout(function(){a.dispatchEvent(new Event("resize"))},100)}},methods:{getTimelineItems:function(a){var b=this;a&&fetch(HSC.api+"/project-timeline/"+a).then(function(a){return a.json()}).then(function(a){b.allTimelineItems=a.timeline_items,b.appClassArray.splice(b.appClassArray.indexOf("is-loading"),1),b.loading=!1}).catch(function(a){console.log("Project Timeline fetch failed",a)})},setupScrollMagic:function(){if(-1!==["lg","xl"].indexOf(hsc.getMediaSize())&&this.visibleTimelineItems.length){this.appClassArray.push("has-scroll-events"),this.scrollMagicController=new ScrollMagic.Controller;var a=this;a.visibleTimelineItems.forEach(function(c){var d=b.getElementById(c.id),e=b.querySelector('[href="#'+c.id+'"]'),f=new ScrollMagic.Scene({triggerElement:d,duration:d.offsetHeight}).addTo(a.scrollMagicController);f.on("enter",function(a){[d,e].forEach(function(a){-1==a.className.indexOf("is-active")&&(a.className+=" is-active")})}),f.on("leave",function(a){[d,e].forEach(function(a){a.className=a.className.split("is-active").join("")})})})}}}})}(this);
//# sourceMappingURL=project-timeline.min.js.map