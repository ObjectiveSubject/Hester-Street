/*! Hester Street Collaborative - v1.0.0
 * http://hesterstreet.org/
 * Copyright (c) 2017; * Licensed GPLv2+ */

!function(a){"use strict";var b=a.document;new Vue({el:"#project-timeline",data:{appClassArray:["is-loading"],loading:!0,allTimelineItems:[],currentFilterGroup:"post-type",currentFilters:{postType:"all",date:"all"},filterToggles:[{name:"Post Type",slug:"post-type"},{name:"Date",slug:"date"}],postTypes:[{name:"Event",slug:"event",type:"postType"},{name:"Events Recap",slug:"events_recap",type:"postType"},{name:"Press",slug:"press",type:"postType"},{name:"Project Kickoff",slug:"kickoff",type:"postType"},{name:"Project Sign Off",slug:"sign_off",type:"postType"},{name:"Project Update",slug:"update",type:"postType"},{name:"Publication",slug:"publication",type:"postType"}],dates:[{name:"Last Month",seconds:2592e3,type:"date"},{name:"Last 3 Months",seconds:7776e3,type:"date"},{name:"Last 6 Months",seconds:15552e3,type:"date"},{name:"Last Year",seconds:31536e3,type:"date"},{name:"Last 3 Years",seconds:94608e3,type:"date"}],scrollMagicController:!1},mounted:function(){projectData&&projectData.id&&this.getTimelineItems(projectData.id)},computed:{appClass:function(){return this.appClassArray.join(" ")},visibleTimelineItems:function(){var a=this.currentFilters.postType,b=this.currentFilters.date,c=this.allTimelineItems;if("all"!==a&&(c=c.filter(function(b){return b.type==a.slug})),"all"!==b){var d=new Date,e=d.getTime()/1e3,f=e-b.seconds;c=c.filter(function(a){return a.date_unix>=f})}return c}},watch:{visibleTimelineItems:function(){this.scrollMagicController&&this.scrollMagicController.destroy(),setTimeout(this.setupScrollMagic,100)}},methods:{toggleFilterGroup:function(a){this.currentFilterGroup=a.slug},toggleFilter:function(a){a.type&&(this.currentFilters[a.type]&&this.currentFilters[a.type].name!==a.name?this.currentFilters[a.type]=a:this.currentFilters[a.type]="all")},getTimelineItems:function(a){var b=this;a&&fetch(HSC.api+"/project-timeline/"+a).then(function(a){return a.json()}).then(function(a){b.allTimelineItems=a.timeline_items,b.appClassArray.splice(b.appClassArray.indexOf("is-loading"),1),b.loading=!1}).catch(function(a){console.log("Project Timeline fetch failed",a)})},setupScrollMagic:function(){if(-1!=["lg","xl"].indexOf(hsc.getMediaSize())&&this.visibleTimelineItems.length){this.appClassArray.push("has-scroll-events"),this.scrollMagicController=new ScrollMagic.Controller;var a=this;a.visibleTimelineItems.forEach(function(c){var d=b.getElementById(c.id),e=b.querySelector('[href="#'+c.id+'"]'),f=new ScrollMagic.Scene({triggerElement:d,duration:d.offsetHeight}).addTo(a.scrollMagicController);f.on("enter",function(a){[d,e].forEach(function(a){-1==a.className.indexOf("is-active")&&(a.className+=" is-active")})}),f.on("leave",function(a){[d,e].forEach(function(a){a.className=a.className.split("is-active").join("")})})})}}}})}(this);
//# sourceMappingURL=project-timeline.min.js.map